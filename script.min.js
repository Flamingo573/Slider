"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),Slider=function(){function a(b){_classCallCheck(this,a),this.wrapper=b.wrapper,this.limiter=b.limiter,this.margin=b.margin,this.amountImg=b.amountImage,this.carousel=b.carousel,this.activeDot=0,this.autoPlayTime=b.autoPlayTime,this.carousel.ondragstart=function(){return!1},this.wrapper.addEventListener("click",bind(this.listenerEvent,this)),this.wrapper.addEventListener("mousedown",bind(this.listenerEvent,this)),window.addEventListener("resize",bind(this.listenerEvent,this)),this.limiter.addEventListener("touchstart",bind(this.listenerEvent,this)),this.limiter.addEventListener("mousedown",bind(this.listenerEvent,this))}return _createClass(a,[{key:"fitWidth",value:function(){for(var b in this.amountImg)if(this.getWidthWrapper()<=this.amountImg[b]){this.getWidthImg(b),this.currentAmountImg=b;break}}},{key:"getWidthWrapper",value:function(){return this.wrapper.offsetWidth}},{key:"getWidthImg",value:function(b){this.widthImg=(this.getWidthWrapper()-this.margin*(b-1))/b}},{key:"setWidthImg",value:function(){for(var b=0;b<this.carousel.children.length;b++){var c=this.carousel.children[b];c.style.width=this.widthImg+"px",c.style.marginRight=this.margin+"px"}}},{key:"setWidthCarousel",value:function(){this.widthCarousel=this.carousel.children.length*(this.widthImg+this.margin),this.carousel.style.width=this.widthCarousel+"px"}},{key:"getStartPositionCaroisel",value:function(){return this.count=-this.getWidthWrapper()-this.margin,this.count}},{key:"listenerEvent",value:function(b){"click"==b.type&&this.wrapper.contains(b.target)&&("button-1"==b.target.className&&this.left(),"button-2"==b.target.className&&this.right(),this.boxDots.contains(b.target)&&b.target.hasAttribute("data-index")&&this.selectedDot(b.target)),"resize"==b.type&&this.start(),"mousedown"==b.type&&this.mouseShiftSlider(b),"touchstart"==b.type&&this.touchShiftSlider(b)}},{key:"renderButtonSlider",value:function(){if(!this.wrapper.querySelector('div[class^="button"]'))for(var b=1;b<3;b++){var c=document.createElement("div");c.classList.add("button-"+b),this.wrapper.appendChild(c)}}},{key:"renderDots",value:function(){var b=this.wrapper.querySelector(".boxDots");b&&this.wrapper.removeChild(b);var c=document.createElement("div");c.classList.add("boxDots");for(var d=Math.ceil((this.carousel.children.length-this.carousel.querySelectorAll(".clone").length)/this.currentAmountImg),e=0;e<d;e++){var f=document.createElement("div");f.setAttribute("data-index",e+1),c.appendChild(f)}this.amountDots=d,this.wrapper.appendChild(c),this.boxDots=c}},{key:"addClone",value:function(){var b=this,c=this.carousel.getElementsByClassName("clone");if(c.length)for(var d=0;d<c.length;d++)this.carousel.removeChild(c[d]),d--;for(var e=[],f=[],g=this.carousel.children.length-1;g>this.carousel.children.length-1-this.currentAmountImg;g--){var h=this.carousel.children[g].cloneNode(!0);h.classList.add("clone"),e.push(h)}for(var i=0;i<this.currentAmountImg;i++){var j=this.carousel.children[i].cloneNode(!0);j.classList.add("clone"),f.push(j)}e.forEach(function(a){return b.carousel.insertBefore(a,b.carousel.firstChild)}),f.forEach(function(a){return b.carousel.appendChild(a)}),this.setWidthCarousel()}},{key:"left",value:function(){this.autoPlay("reset"),this.carousel.style.transition="transform 500ms",this.count+=this.widthImg+this.margin,Math.round(this.count)>-this.getWidthWrapper()&&this.endCarousel("left"),this.setPositionCarousel(),this.getActiveDots()}},{key:"right",value:function(){this.autoPlay("reset"),this.carousel.style.transition="transform 500ms",this.count-=this.widthImg+this.margin,Math.round(this.count)<this.getLastPositionCarousel()&&this.endCarousel("right"),this.setPositionCarousel(),this.getActiveDots()}},{key:"endCarousel",value:function(b){this.carousel.style.transition="",this.count="left"==b?this.getLastPositionCarousel():this.getStartPositionCaroisel(),this.setPositionCarousel(),"left"==b?setTimeout(bind(this.left,this),10):setTimeout(bind(this.right,this),10)}},{key:"getLastPositionCarousel",value:function(){return-this.widthCarousel+this.getWidthWrapper()+this.margin}},{key:"setPositionCarousel",value:function(){this.carousel.style.transform="translateX("+this.count+"px)"}},{key:"selectedDot",value:function(b){this.autoPlay("reset");var c=b.getAttribute("data-index");this.count=-c*(this.getWidthWrapper()+this.margin),this.setPositionCarousel(),this.activeDot=c-1,this.setActiveDot()}},{key:"getActiveDots",value:function(){var b=Math.abs(Math.round(this.count));if(Math.round(this.count)<=this.getLastPositionCarousel())return this.activeDot=0,void this.setActiveDot();for(var c=this.amountDots+1;0!=c;c--){var d=b>=this.objectForShiftDots[c]&&b<=this.objectForShiftDots[c+1];if(d){this.activeDot=c-1,this.setActiveDot();break}}}},{key:"setActiveDot",value:function(){for(var b=0;b<this.amountDots;b++)this.boxDots.children[b].classList.remove("active");this.boxDots.children[this.activeDot].classList.add("active")}},{key:"setObjectForShiftDots",value:function(){for(var b={},c=1;c<this.amountDots+1;c++)b[c]=c*(this.getWidthWrapper()+this.margin);b[this.amountDots+1]=Math.abs(this.getLastPositionCarousel()),this.objectForShiftDots=b}},{key:"touchShiftSlider",value:function(b){this.autoPlay("stop"),this.carousel.style.transition="";var c=this.count,d=b.targetTouches[0].clientX,e=0;window.ontouchmove=bind(function(a){e=a.targetTouches[0].clientX,this.count=c-(d-e);var b=Math.round(-this.getWidthWrapper()-this.margin),f=Math.round(this.getLastPositionCarousel());Math.round(this.count)>b&&Math.round(this.count)>f&&(this.count=this.getLastPositionCarousel(),c=this.count,d=e),Math.round(this.count)<f&&Math.round(this.count)<b&&(this.count=-this.getWidthWrapper()-this.margin,c=this.count,d=e),this.setPositionCarousel(),this.getActiveDots()},this),window.ontouchend=bind(function(a){this.carousel.style.transition="transform 500ms";var b=d-(e||d),f=Math.abs(b/this.widthImg).toFixed(2),h=(+f.split(".")[0],+f.split(".")[1]),i=Math.abs(h)>25?Math.ceil(f):Math.floor(f);b<0&&(this.count=c+this.widthImg*i+this.margin*i),b>0&&(this.count=c-this.widthImg*i-this.margin*i),this.setPositionCarousel(),this.getActiveDots(),this.autoPlay("play"),window.ontouchmove=null,window.ontouchstart=null,window.ontouchend=null},this)}},{key:"mouseShiftSlider",value:function(b){this.autoPlay("stop"),this.carousel.style.transition="",this.wrapper.classList.add("grab");var c=this.count,d=b.clientX,e=0;window.onmousemove=bind(function(a){e=a.clientX,this.count=c-(d-e);var b=Math.round(-this.getWidthWrapper()-this.margin),f=Math.round(this.getLastPositionCarousel());Math.round(this.count)>b&&Math.round(this.count)>f&&(this.count=this.getLastPositionCarousel(),c=this.count,d=e),Math.round(this.count)<f&&Math.round(this.count)<b&&(this.count=-this.getWidthWrapper()-this.margin,c=this.count,d=e),this.setPositionCarousel(),this.getActiveDots()},this),window.onmouseup=bind(function(a){this.carousel.style.transition="transform 500ms";var b=d-(e||d),f=Math.abs(b/this.widthImg).toFixed(2),h=(+f.split(".")[0],+f.split(".")[1]),i=Math.abs(h)>25?Math.ceil(f):Math.floor(f);b<0&&(this.count=c+this.widthImg*i+this.margin*i),b>0&&(this.count=c-this.widthImg*i-this.margin*i),this.setPositionCarousel(),this.getActiveDots(),this.wrapper.classList.remove("grab"),this.autoPlay("play"),window.onmousemove=null,window.onmousedown=null,window.onmouseup=null},this)}},{key:"autoPlay",value:function(b){var c=this.autoPlayTime;c&&("play"==b&&(clearInterval(this.timeId),this.timeId=setInterval(bind(function(){this.right()},this),c)),"stop"==b&&clearInterval(this.timeId),"reset"==b&&(clearInterval(this.timeId),this.autoPlay("play")))}},{key:"start",value:function(){this.fitWidth(),this.setWidthImg(),this.getStartPositionCaroisel(),this.setPositionCarousel(),this.renderButtonSlider(),this.renderDots(),this.setActiveDot(),this.addClone(),this.setObjectForShiftDots(),this.autoPlay("play")}}]),a}(),slider=new Slider({wrapper:document.getElementById("slider"),carousel:document.getElementsByClassName("carousel")[0],limiter:document.getElementsByClassName("limiterForWidth")[0],amountImage:{5:960,3:850,1:500},margin:10,autoPlayTime:5e3});slider.start();
